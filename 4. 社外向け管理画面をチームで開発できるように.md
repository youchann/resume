※社内の評価会にて作成した資料を外部向けに修正したものとなります

## 概要

- 社外向け管理画面を海外の顧客でも利用可にすべく機能の追加を行なっていた（2024/5/16時点で完了）
- その過程で組織体制が変わったのもあり、属人化に近い体制を変えるべくチーム単位で開発を行うことに注力した
- 事業数値の向上に必要な機能群を実装しつつも、トラック係数の削減やチームでの開発効率の向上に寄与している状態となっている

## 期間

2023年〜半年以内

## 背景

- チーム構成の変遷
  - 過去の開発体制
    - 4人
      - プロダクトマネージャー
      -	デザイナー
      -	バックエンドエンジニア
      -	フロントエンドエンジニア(筆者)
    -	要所で集まりMTGを行う
    - 開発初期というのもあり、タスクフォース的に集まったメンバーで開発をしていた
  - 現在の開発体制
    - 2023年2月初旬あたりから、社外向け管理画面開発の専任に近しいチームが生まれた
    - ほぼ同じタイミングで業務委託の方2名が参加してくださっている
    - エンジニアはバックエンドエンジニアが抜けて5人が新たに参画、計6人が社外向け管理画面のオーナーシップを持とうとしている状態
    - その他はプロダクトマネージャー・デザイナー、要所で別のチームともコミュニケーションを取っている

### やるべきこと

#### 増えた開発メンバーのオンボーディング

- 増えたからといって開発が加速するわけではない
  - 実際に開発を行いつつ、コードベースに慣れてもらう必要がある（いわゆる「オンボーディング」）
- 2人 → 6人にメンバーが増えた
- オンボーディングにも段階がある
  - 例えば以下のようなものがあり、1から順にできることが増えていくことが望ましいと考えている
    1. 軽微な修正タスクが完遂できること
    2. アーキテクチャに沿った機能開発ができていること
    3. PRのレビューができること
    4. プロダクトの行く末を把握しそれに沿った開発タスクを考えられること

#### Backendアプリケーションをチームでハンドリングできるように

- Backendの領域は今回の体制変更で抜けた1人が丸っと担っている状態だった
- 新たなチームが社外向け管理画面全体にオーナーシップを持つにあたり、1人に依存する形状をなるべく早く脱却しておきたい
- 体制変更の意図としてオーナーシップを移譲というより広げるというニュアンスが近いが、なるべく早くチームだけでハンドリングできる状態を目指したい
  - 抜けた人が所属しているチームも忙しい
    - 本人になるべくコンテキストスイッチを発生させたくない
  - 単一のチームのみでハンドリングできた方がコミュニケーションが取りやすい
    - 開発のコンテキストは移り変わるものなので抜けた個人 - チーム間のコミュニケーションコストがどんどん膨らんでいく

## やったこと

先述したオンボーディングの段階に沿って、やったことを書いていく。

### 1. 軽微な修正タスクが完遂できること

#### Design DocやADRの導入

古いコードベースを見ていて、どういった背景でこのアーキテクチャになったのかを知りたいのに知れない場面が多々あった。社外向け管理画面ではそういった思想や考えをリポジトリ内に残す動きをしている。

- Design Doc（別プロジェクト「社外向け管理画面の立ち上げ」で記載）
- ADR（Architectural Decision Record）
  - Design Docに書かれたものがずっと続くわけではなく、アーキテクチャは漸進的に進化していくもの
  - 変更を加えようとするとDesign Docとの乖離が生まれてしまう
  - その度にDesign Docを修正するのは手間
    - 修正箇所の特定が面倒
    - 決定までのコンテキストを書こうとすると文量が多くなってしまい読みづらくなってしまう
  - https://zenn.dev/souppower/articles/bfdf79069ae9a7 のフォーマットを参考に書くようにした

結果、新たに入った開発メンバーがスムーズにコードベースへの理解を深めることができた。

下記はチームでのKPTで記載されていたものとなる。

- > 開発面でのドキュメントや体制がすでに整っていたため、ほとんど疑問点を感じずにJOINできた
- > 作りがとてもしっかりしてる、ドキュメントもあって途中参入組としては助かる

### 2. アーキテクチャに沿った機能開発ができていること

#### 自身がBackendの開発をできるようにして、抜けたメンバーへの依存をなくす

そもそも自身がまずBackendを担えるようになる必要がある。

もともとある程度はBackendの開発に携わっているということもあり、この辺りの課題は自身がオーナーシップを持ちながら機能開発を行うことで対処している。チームで足並みを揃えようとすると時間がかかると考え、まずは自身が開発できるようになることにフォーカスした。

（具体的なやったことに関してはGithubのPull Requestを参照していたため割愛）

#### 自身がreviewをしつつ、コードベースに関する知見頒布を行う

アプリケーション全般を見れるようになったというのもあり、徐々にReviewerのアサインが自身に集中するようになった。ここは現在も根気良くReviewを続けている。自身以外の人でもReviewができるようにすべく、ミクロなコードに対する指摘というよりはDesign Docでは補えなかったアーキテクチャの部分や言語特有のプラクティスを共有するよう心がけている。以下に例を示す。

- > `0`という値がマジックナンバーになってるっぽいので、`entity`側で定義させておくと良さそうです！`entity`のレイヤーに似たような実装があったような（数字に対して変数名を割り当てるようなアレが
- > repository内のメソッド命名、こんな感じにしようかなと思っているのですがどうでしょう...?:thinking:
  - > 複数のリソースを取得するものはlist
  - > 単一のリソースを取得するものはget
  - > リソースの変更はすでにcreate, delete, updateになっていたが厳密に決めていない(upsertはあったほうがわかりやすいなと思っている)
- > 全体最適で考えると妥当なのですが、設計の視点で考えると悩ましいポイントがあるんですよねぇ...
entityとして持つドメインがどういった形式なのか？という情報はクリーンアーキテクチャでいうと最重要ビジネスロジックなので、持っておいた方が良いと思ってます。今の実装上だと変な文字列がentityのdomainとして扱われることはないですが、初見エンジニアからすると「あっ、Domainという名前だけど文字列であればなんでも良いのか」と解釈されてもおかしくないです。
scalar/domain.goにあるロジックがentity/のレイヤーの中にあるような構造だと適切かもしれません。

また一部のメンバーには当人のバックグラウンドに応じたタスクを振っていたが、少しづつ得意領域を跨ぐような仕事の振り方をしている。特定の領域のみ開発できるという状態はトラック係数を向上させているとはいえないため。
まだ一例しかないが、最終的には機能を開発したりReviewを行えるところまで持っていきたい。

#### 共通認識を持ちたい分野の勉強会

チームメンバーそれぞれが広義のWebアプリケーション開発の経験はあるものの、GraphQLを用いた開発の経験はほぼ無いに等しかった。キャッチアップするにはまとまった時間が必要で、なおかつ開発には必須となる知識である。この辺りは足並みを揃えるような取り組みが必要であると感じた。

取り組みとしては読書会を行うことにした。単なる勉強会とは毛色が異なるので、目的を先んじて共通認識で持つようにした。

結果、チームメンバーがひとまずGraphQLスキーマを書ける状況にはなった。

### 3. PRのレビューができること

#### 小さくPull Requestのレビューをお願いする

軽微な修正などに関しては自身でなくともReviewできる状態になりつつと判断し、Teamに対してアサインするように啓蒙している途中。

先述と同じものの引用にはなるが、GraphQLスキーマに関しては直近でReviewをお願いするようにしてみた。

様子を見つつどこまで手を放すかは考えていく。読んでいる書籍やその中で言及している[GraphQL Server Specification](https://relay.dev/docs/guides/graphql-server-specification/)からの引用が出てき始めたら、それは読書会の狙い通りの成果であり、自身がいなくともReviewができるという判断材料になる。

## まとめ

- 自身がFrontendだけでなくBackendにもオーナーシップを持つようになった
- 新たに入った開発メンバーがスムーズにキャッチアップできる状態を作れていた
- 自身がいなくとも機能の実装・Reviewが行えるようになりつつある
- KPT会でこんな声をいただいた
  - > 〇〇さん（筆者の名前）が社外向け管理画面のオーナーシップを持っていてすごい

## 今後の展望

- > プロダクトの行く末を把握しそれに沿った開発タスクを考えられること
  - このあたりは実際に開発やPull Requestの議論、また社外向け管理画面のBizメンバーを含めた定例などでのコミュニケーションを通じて培われていくものだと考えている
  - 具体的なアクションというよりは自らの背中を見せつつ待つイメージ
- 社外向け管理画面以外のプロダクトあるいは隣接する領域にも手を掛ける
  - デザインシステム（ingred-ui）
  - 社内向け管理画面と環境を分ける
  - 社内向け管理画面の方のコードベースの負債対処
